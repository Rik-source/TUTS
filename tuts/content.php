<!doctype html>
<html>

<head>
    <title>F-Society Tenants</title>
    <meta name="description" content="Dashboard F-Society">
    <meta name="keywords" content="html tutorial template">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="Source/style.css">
</head>

<body style="padding: 0; margin: 0; background-color: rgba(31, 30, 32, 0.877); color: rgb(238, 87, 87);">
    <div class="Contentbox" style="min-height: 100vh;">
        <div style="min-height: 15vh">
            <h1 style="text-align:center;border: solid; max-width: 50%;max-height: 25vh; margin: 10px auto 40px auto; ">
                F-Society Appartment</h1>
        </div>
        <div class="Leftbox"
            style="width: 50%;min-height: 85vh; background-color: rgba(58, 57, 59, 0.877); float: left;">
            <h1 style="text-align:center;border: solid; width: 50%; margin: -25px auto 25px auto;">
                Tenant's</h1>
            <div class="Leftbox" style="width: 100%;">
                <div id="carouselContent" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner" role="listbox">
                        <div class="carousel-item active text-center p-4">
                            <h2>Rowen</h2>
                            <p>He is our advanced infrastructure man for all the questions.<br> We ASK ROWEN OUR SAVIOUR
                                what to do!</p>
                        </div>
                        <div class="carousel-item text-center p-4">
                            <h2>Storm</h2>
                            <p>Our Smallest child/ginger of the group he never knows what is going on but he is always
                                willing to work his ass of. his grandma bakes the best waffles!</p>
                        </div>
                        <div class="carousel-item text-center p-4">
                            <h2>Rik</h2>
                            <p>Our rikkert! Our rich guy of the group. dont go to the issd with him because he will make
                                you carry the heavy stuff and laugh at you while doing it :(</p>
                        </div>
                        <div class="carousel-item text-center p-4">
                            <h2>Bas</h2>
                            <p>THE ONE AND ONLY BOSS!!! doesnt understand how to bus system work and that is why he
                                always late :)</p>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselContent" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselContent" style="margin-bottom: -100px;"
                        role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <div class="Leftbox" style="width: 100%;">
                <h1 style="text-align:center;border: solid; width: 50%; margin: 0 auto">
                    Services Available</h1>
                <div id="carouselContent" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner" role="listbox">
                        <div class="carousel-item active text-center p-4">
                            <h2>Add Blocker</h2>
                            <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Consectetur eaque dignissimos
                                animi autem, dolor quibusdam voluptas hic qui modi fugit eum nam tempore nesciunt
                                dolorum repellendus, id ea, voluptates consequuntur?</p>
                        </div>
                        <div class="carousel-item text-center p-4">
                            <h2>Webserver</h2>
                            <p>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Alias dolor id reprehenderit
                                odio eos sed nam beatae quod consequuntur nisi. Quae nobis temporibus vero voluptatum
                                delectus ipsa tenetur molestias asperiores.</p>
                        </div>
                        <div class="carousel-item text-center p-4">
                            <h2>Electricity monitoring</h2>
                            <p>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Alias dolor id reprehenderit
                                odio eos sed nam beatae quod consequuntur nisi. Quae nobis temporibus vero voluptatum
                                delectus ipsa tenetur molestias asperiores.</p>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselContent" role="button"
                        style="margin-bottom: -100px;" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselContent" style="margin-bottom: -100px;"
                        role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
        <div class="Rightbox"
            style="width: 50%;min-height: 85vh; background-color: rgba(58, 57, 59, 0.877); float: right;">
            <!-- MAKE IT SO THAT THE ELECTRICITY MONITORING IS AVAILABLE HERE -->
            
            <h1
                style="text-align:center;border: solid; background-color: rgba(204, 59, 59, 0);color: rgb(238, 87, 87); width: 50%; margin: -25px auto 25px auto;">
                Energy monitoring</h1>
            <table class= "styled-table">
                <tbody>
                    <tr>
                        <td>index</td>
                        <td>Last Month</td>
                        <td>current</td>
                    </tr>
                    <tr>
                        <td>price/kwh</td>
                        <td>€ 0.80</td>
                        <td>€ 0.80</td>
                    </tr>
                    <tr>
                        <td>Monthly cost</td>
                        <td>
                            <?php
                            include("connect.php");
                            $sql = "SELECT timestamp FROM tb_energydata ORDER BY id DESC LIMIT 1";
                            $result = $conn->query($sql);
                            $result = $result->fetch_assoc();
                            
                            $previousmonth = $result["timestamp"] - 1;
                            
                            $sql2 = "SELECT EnergyTotal FROM tb_energydata WHERE timestamp < DATE_SUB(NOW(),INTERVAL 30 ORDER BY id DESC LIMIT 1";
                            //$sql2 = "SELECT EnergyTotal FROM tb_energydata WHERE  'timestamp' >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)";
                            $result2 = $conn->query($sql2);

                            if ($result2->num_rows > 0) {
                                // output data of each row
                                while ($row = $result2->fetch_assoc()) {
                                    $pricekwh = 0.80;
                                    echo "€ " . $row["EnergyTotal"] * $pricekwh . "<br>";
                                }
                            } else {
                                echo "Still doesn't fucking WORRKKKK";
                            }


                            $conn->close();
                            ?>
                        </td>
                        <td>
                            <?php
                            include("connect.php");
                            $sql = "SELECT * FROM tb_energydata ORDER BY id DESC LIMIT 1";
                            $result = $conn->query($sql);

                            if ($result->num_rows > 0) {
                                // output data of each row
                                while ($row = $result->fetch_assoc()) {
                                    $pricekwh = 0.80;
                                    echo "€ " . $row["EnergyTotal"] * $pricekwh . "<br>";
                                }
                            } else {
                                echo "0 results";
                            }


                            $conn->close();
                            ?>
                        </td>
                        
                    </tr>
                    <tr class="active-row">
                        <td>Montly energy consumption</td>
                        <td>
                            <?php
                            include("connect.php");
                            $sql2 = "SELECT EnergyTotal FROM tb_energydata WHERE MONTH(timestamp)=11 ORDER BY id DESC LIMIT 1";
                            //$sql2 = "SELECT EnergyTotal FROM tb_energydata WHERE  `date` >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)ORDER BY id DESC LIMIT 1";
                            $result2 = $conn->query($sql2);

                            if ($result2->num_rows > 0) {
                                // output data of each row
                                while ($row = $result2->fetch_assoc()) {
                                    $pricekwh = 0.80;
                                    echo  ($row["EnergyTotal"] . " KwH");
                                }
                            } else {
                                echo "0 results";
                            }


                            $conn->close();
                            ?>
                        </td>
                        <td>
                            <?php
                            include("connect.php");
                            $sql = "SELECT * FROM tb_energydata ORDER BY id DESC LIMIT 1";
                            $result = $conn->query($sql);

                            if ($result->num_rows > 0) {
                                // output data of each row
                                while ($row = $result->fetch_assoc()) {
                                    $pricekwh = 0.80;
                                    echo  $row["EnergyTotal"] . " KwH";
                                }
                            } else {
                                echo "0 results";
                            }


                            $conn->close();
                            ?>
                        </td>
                        
                    </tr>
                    <!-- and so on... -->
                </tbody>


            </table>
            </h1>
        </div>
    </div>
</body>
</html>